# 字数调整 - 1500-2000字/章 - 2026-02-04

## 调整需求

**目标字数**: 1500-2000字/章（从 2000-2500字 减少）

**减少幅度**: ~25%

---

## 修改内容

### 1. Writer 节点 - 分段生成

**文件**: `src/nodes/writer.py` (line 142)

**之前**:
```python
1. 字数: 300-500字
```

**之后**:
```python
1. 字数: 250-400字
```

**效果**: 4-5个场景 × 250-400字 = **1500-2000字** ✅

---

### 2. Writer 节点 - 单段生成

**文件**: `src/nodes/writer.py` (line 219)

**之前**:
```python
1. 字数: 2000-2500字（严格控制）
```

**之后**:
```python
1. 字数: 1500-2000字（严格控制）
```

**效果**: 单段直接生成 **1500-2000字** ✅

---

### 3. Planner 节点 - 场景规划

**文件**: `src/nodes/planner.py` (lines 152-153)

**之前**:
```python
- 每个场景可用 300-500 字展开
- 总计 4-5 个场景，形成完整2000-2500字章节
```

**之后**:
```python
- 每个场景可用 250-400 字展开
- 总计 4-5 个场景，形成完整1500-2000字章节
```

**效果**: Planner 规划时考虑新的字数目标 ✅

---

## 预期效果

### 字数分布
- **目标**: 1500-2000字/章
- **实际**: 应该在目标范围内
- **允许偏差**: ±200字（1300-2200字可接受）

### 生成速度
- **提升**: ~25% 更快（字数减少 25%）
- **API 成本**: 降低 ~25%
- **每章生成时间**: 预计减少 1-2 分钟

---

## 对比总结

| 项目 | 之前 (2000-2500字) | 现在 (1500-2000字) | 变化 |
|------|-------------------|-------------------|------|
| 分段字数 | 300-500字 | 250-400字 | -20% |
| 单段字数 | 2000-2500字 | 1500-2000字 | -25% |
| 场景数量 | 4-5个 | 4-5个 | 不变 |
| 生成速度 | 基准 | 快25% | ⬆️ |
| API成本 | 基准 | 降低25% | ⬇️ |

---

## 验证建议

```bash
# 生成测试
./novel.sh generate
```

**检查项**:
1. 章节字数是否在 1500-2000 字范围
2. 场景是否完整（4-5个场景）
3. 内容质量是否保持

---

## 如果字数仍不理想

### 字数太少（< 1500字）

调整 `writer.py`:
```python
# 分段模式
1. 字数: 280-420字  # 增加每段字数

# 单段模式
1. 字数: 1600-2100字  # 增加目标范围
```

### 字数太多（> 2000字）

调整 `writer.py`:
```python
# 分段模式
1. 字数: 220-380字  # 减少每段字数

# 单段模式
1. 字数: 1400-1900字  # 减少目标范围
```

---

**状态**: ✅ 已调整完成
**测试**: 运行 `./novel.sh generate` 验证
