# 总纲和卷纲生成工具使用指南

## 功能介绍

这个工具用于：
1. ✅ 使用 AI 生成小说的**总纲**（整体规划）
2. ✅ 使用 AI 生成小说的**卷纲**（每卷详细规划）
3. ✅ 显示给用户审查是否合理
4. ✅ 保存到配置文件供生成使用

---

## 使用方法

### 方式 1: 使用 novel.sh（推荐）

```bash
./novel.sh outline
```

### 方式 2: 直接运行

```bash
python3 generate_outline.py
```

---

## 工作流程

### 1. 启动工具

```bash
./novel.sh outline
```

### 2. 生成总纲和卷纲

工具会：
- 读取你的配置文件（`bible/novel_config_latest.yaml`）
- 使用 AI 分析你的故事梗概
- 生成总纲（主线目标、主要冲突、主角成长弧、关键里程碑）
- 生成卷纲（每卷25章，包括标题、核心目标、关键事件、伏笔等）

### 3. 审查内容

工具会显示类似这样的内容：

```
======================================================================
📖 总纲 (Novel Outline)
======================================================================

🎯 主线目标:
   陆沉在生存游戏中逐步揭开游戏真相，最终逃脱并揭露幕后真相

⚔️  主要冲突:
   陆沉需要在残酷的生存游戏中保持理智和人性，同时与其他玩家竞争/合作

🌱 主角成长弧:
   从普通大学生成长为能看透人性、冷静应对危机的生存高手

🎯 关键里程碑:
   1. 第20章: 首次副本通关，获得核心能力
   2. 第50章: 揭开游戏背后的第一层真相
   3. 第100章: 最终对决，逃出生天

======================================================================
📚 卷纲 (Volume Frameworks)
======================================================================

【第 1 卷】新手生存
   章节范围: 1-25
   核心目标: 在首个副本中生存下来，了解游戏基本规则
   关键事件:
      1. 初次进入寂静公寓副本
      2. 发现并破解隐藏规则
      3. 与其他玩家建立初步信任关系
      4. 首次面对"游戏主宰"
      5. 成功通关并获得生存点
   结尾状态: 通关第一个副本，但意识到游戏远比想象中可怕
   埋下伏笔:
      1. 游戏背后的真正目的
      2. 某个NPC的真实身份
      3. 主角隐藏的特殊能力

【第 2 卷】危机升级
   ...
```

### 4. 决定是否保存

工具会询问：

```
是否保存到配置文件？ (y/n/r)  [y=保存, n=放弃, r=重新生成]:
```

**选项**:
- `y` - 保存到配置文件，可以开始生成
- `n` - 放弃，不修改配置
- `r` - 不满意？重新生成！

---

## 示例输出

### 总纲结构

```yaml
novel_outline:
  main_goal: "整部小说的核心目标（50字以内）"
  main_conflict: "贯穿全文的主要矛盾（100字以内）"
  protagonist_arc: "主角的成长变化（100字以内）"
  key_milestones:
    - milestone: "重要剧情节点"
      target_chapter: 20
    - milestone: "重要剧情节点"
      target_chapter: 50
```

### 卷纲结构

```yaml
volume_frameworks:
  - title: "第一卷标题"
    chapters: "1-25"
    core_goal: "本卷要达成的目标"
    key_events:
      - "关键事件1"
      - "关键事件2"
      - "关键事件3"
    ending_state: "本卷结束时的状态"
    foreshadowing:
      - "需要埋下的伏笔1"
      - "需要埋下的伏笔2"
```

---

## 常见问题

### Q1: 生成的总纲不满意怎么办？

**A**: 选择 `r` 重新生成，AI 会生成不同的版本。

### Q2: 可以手动修改总纲和卷纲吗？

**A**: 可以！
1. 先保存 AI 生成的版本
2. 用文本编辑器打开 `bible/novel_config_latest.yaml`
3. 找到 `novel_outline` 和 `volume_frameworks` 部分
4. 手动修改为你想要的内容

### Q3: 什么时候需要生成总纲和卷纲？

**A**:
- ✅ 创建新小说时（尤其是长篇 50+ 章）
- ✅ 开始生成前想要审查整体规划
- ✅ 配置文件缺少总纲/卷纲时

### Q4: 短篇小说（< 50 章）需要吗？

**A**: 不是必须的，但**强烈建议**：
- 有总纲能让故事更连贯
- 有卷纲能让情节更有层次
- AI 生成的章节会参考这些规划

---

## 保存位置

生成的总纲和卷纲会保存到：

```
bible/novel_config_latest.yaml
```

**备份**: 工具会自动备份原文件为：
```
bible/novel_config_latest_backup_20260204_143022.yaml
```

---

## 与生成流程的关系

```
1. 运行 ./novel.sh new          # 创建基础配置
   ↓
2. 运行 ./novel.sh outline      # 生成总纲和卷纲（新增！）
   ↓
3. 审查并保存
   ↓
4. 运行 ./novel.sh generate     # 开始生成
```

**好处**:
- ✅ 生成前就知道整体规划
- ✅ 可以提前调整不合理的地方
- ✅ AI 生成章节时会遵循总纲和卷纲
- ✅ 长篇小说（200+章）更有连贯性

---

## 技术细节

### AI 模型
- 使用 `claude-sonnet-4-5-20250929`
- Temperature: 0.7（平衡创造性和合理性）

### 生成时间
- 总纲：~10-20 秒
- 卷纲：~20-40 秒（取决于卷数）
- 总计：< 1 分钟

### 重新生成
- 每次生成都是独立的
- 可以多次生成选择最满意的版本

---

## 示例使用流程

```bash
# 1. 创建新配置
./novel.sh new
# 输入: 标题、梗概、目标章节数等

# 2. 生成总纲和卷纲
./novel.sh outline
# AI 生成 → 审查 → 保存 或 重新生成

# 3. 查看配置（确认总纲已保存）
./novel.sh config

# 4. 开始生成
./novel.sh generate
```

---

## 最佳实践

### 1. 先完善梗概

在生成总纲前，确保 `synopsis` 写得清晰：
- ✅ 说明主角是谁，目标是什么
- ✅ 说明主要冲突是什么
- ✅ 说明故事的背景设定

### 2. 合理设置章节数

- 短篇（< 50章）：1-2卷
- 中篇（50-100章）：2-4卷
- 长篇（100-200章）：4-8卷
- 超长篇（200+章）：8+卷

### 3. 审查关键点

重点检查：
- ✅ 主线目标是否吸引人
- ✅ 主要冲突是否能支撑整部小说
- ✅ 每卷的核心目标是否清晰
- ✅ 卷与卷之间是否有递进关系
- ✅ 伏笔是否合理（不要太多也不要太少）

---

**工具状态**: ✅ 已创建并集成到 novel.sh
**使用命令**: `./novel.sh outline`
