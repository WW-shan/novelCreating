# 多项目管理说明

## 功能概述

系统现在支持同时管理多个小说项目，每个项目拥有独立的：
- ✅ 配置文件
- ✅ 数据库（保存进度）
- ✅ 章节文件目录
- ✅ 世界观数据

## 项目结构

```
/project/novel/
├── projects/                    # 所有项目存储目录
│   ├── projects_index.json     # 项目索引
│   ├── current_project.txt     # 当前激活项目
│   ├── 末日真理从收割生存点开始/   # 项目1
│   │   ├── config.yaml         # 项目配置
│   │   ├── state.db            # 生成进度
│   │   ├── manuscript/         # 章节文件
│   │   └── bible/              # 世界观数据
│   └── 另一本小说/               # 项目2
│       ├── config.yaml
│       ├── state.db
│       ├── manuscript/
│       └── bible/
├── src/                        # 源代码
├── configure_novel.py          # 配置向导
├── main.py                     # 生成器
└── manage_projects.py          # 项目管理器 (新)
```

## 使用流程

### 1. 创建新项目

```bash
python3 configure_novel.py
```

配置向导会引导你创建新项目，系统会自动：
- 生成项目ID（基于小说标题）
- 创建项目目录结构
- 保存配置文件
- 设置为当前项目

### 2. 生成章节

```bash
python3 main.py
```

系统会：
- 自动检测当前项目
- 如果配置中的标题与当前项目一致，继续该项目
- 如果配置中的标题不同，创建新项目
- 支持断点续传（进度保存在项目专属数据库中）

### 3. 管理项目

```bash
python3 manage_projects.py
```

交互式菜单，支持：
- 📋 **查看所有项目**：显示项目列表、进度、状态
- 🔄 **切换当前项目**：选择要继续写作的项目
- 🗑️ **删除项目**：删除不需要的项目及其所有数据
- 📊 **查看项目详情**：查看项目的详细信息和路径

## 实际场景示例

### 场景1：同时写两本小说

```bash
# 第一本：末日真理
python3 configure_novel.py
# 输入标题：末日真理从收割生存点开始
# 目标章节：100

python3 main.py
# 生成10章后暂停...

# 第二本：仙侠小说
python3 configure_novel.py
# 输入标题：剑道独尊
# 目标章节：200

python3 main.py
# 生成20章...

# 切换回第一本继续写
python3 manage_projects.py
# 选择"切换项目" → 选择"末日真理从收割生存点开始"

python3 main.py
# 自动从第11章继续生成
```

### 场景2：查看所有项目进度

```bash
python3 manage_projects.py
```

输出示例：
```
================================================================================
📚 小说项目列表
================================================================================
👉 ✅ 末日真理从收割生存点开始
     ID: 末日真理从收割生存点开始
     进度: 100/100 章
     更新: 2026-02-06 07:48:23

   ⏳ 剑道独尊
     ID: 剑道独尊
     进度: 20/200 章
     更新: 2026-02-06 08:15:42

   📝 星际战争
     ID: 星际战争
     进度: 0/50 章
     更新: 2026-02-06 09:00:00
```

## 项目状态说明

- **📝 created**：项目已创建，尚未开始生成
- **⏳ in_progress**：正在生成中
- **✅ completed**：已完成全部章节

## 数据安全

- 每个项目的数据完全独立，互不影响
- 删除一个项目不会影响其他项目
- 支持断点续传，意外中断不会丢失进度
- 数据库自动保存，无需手动操作

## 常见问题

### Q: 如何删除旧项目？
```bash
python3 manage_projects.py
# 选择"删除项目" → 选择要删除的项目 → 输入"yes"确认
```

### Q: 如何找到某个项目的文件？
```bash
python3 manage_projects.py
# 选择"查看项目详情" → 会显示所有路径
```

### Q: 可以同时运行多个项目吗？
不建议。虽然数据独立，但同时运行会竞争API资源。建议一次只运行一个项目。

### Q: 如何备份项目？
复制整个项目目录：
```bash
cp -r /project/novel/projects/末日真理从收割生存点开始 /backup/
```

### Q: 旧的manuscript目录怎么办？
系统会保持兼容：
- 旧项目的文件仍在 `/project/novel/manuscript/`
- 新项目的文件在 `/project/novel/projects/项目名/manuscript/`
- 可以手动迁移旧文件到新结构
